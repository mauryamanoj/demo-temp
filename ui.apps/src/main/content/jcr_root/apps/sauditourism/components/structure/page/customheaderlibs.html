<sly data-sly-use.clientlib="/libs/granite/sightly/templates/clientlib.html">
    <sly data-sly-call="${clientlib.css @ categories='sauditourism.base'}"></sly>
    <sly data-sly-test="${wcmmode.preview || wcmmode.edit}"
         data-sly-call="${clientlib.css @ categories='sauditourism.author'}"/>
</sly>

<!-- pre-hiding code snippet -->
<script>
      !function(o){var e="at-body-style";function t(){return o.getElementsByTagName("head")[0]}!function(e,t,n){if(e){var i=o.createElement("style");i.id=t,i.innerHTML=n,e.appendChild(i)}}(t(),e,"body {opacity: 0 !important}"),setTimeout(function(){!function(e,t){if(e){var n=o.getElementById(t);n&&e.removeChild(n)}}(t(),e)},3001)}((window,document));

</script>
<sly data-sly-test="${!inheritedPageProperties.branding || inheritedPageProperties.branding == 'visitsaudi'}">
    <!-- Adobe Launch Embed Code -->
    <sly data-sly-use.mode="com.saudi.tourism.core.models.app.page.ModeModel">
        <script>
  function setAirTargetInfo() {
                      window.airTargetInfo={}
                      /* eslint-disable-next-line no-console */
                      var mbox;
                      var recommendedSections = []; // the title of the UI component which is related to the selected mbox
                      /* Partners_Promotions */
                      if (window.location.pathname.endsWith("Partners_Promotions")) {
                          mbox = "partner-mbox";
                          recommendedSections = ["Partners Promotions"];
                      }
                      /* Attractions */
                      else if (window.location.pathname.endsWith("Dir-iyah")) {
                          mbox = "attractions-mbox";
                          recommendedSections = ["Attractions you may like"];
                      }
                      /* lifestyle activities */
                      else if (window.location.pathname.endsWith("work-friendly-cafes-in-jeddah")) {
                          mbox = "attractions-mbox";
                          recommendedSections = ["Discover lifestyle activities in Saudi"];
                      }
                      /* destinations */
                      else if (window.location.pathname.includes( "/see-do/destinations/" )) {
                          const urlParts = window.location.pathname.split("/en/see-do/destinations/");
                    
                          if (urlParts.length > 1 && urlParts[1].includes("/")) {
                              mbox = "attractions-mbox";
                              recommendedSections = ["Attractions you may like" , "Guides"]; 
                          } else {
                              mbox = "city-mbox"; //,"dest-map-mbox","discover-mbox"];
                              recommendedSections = [
                                  "Explore Destination",
                                  "Cities of Saudi Arabia" , 
                                  "Discover more regions" , 
                                  "Trending destinations",
                                  "Explore the best places to visit"
                              ];
                          }
                          if (window.location.pathname.endsWith("province")) {
                              mbox = "region-mbox";
                              recommendedSections = ["Explore regions"];
                          }
                      } 
                      else if (
                          window.location.pathname.includes("/adventure-activities")
                      ) {
                          mbox = "discover_adventure_mbox";
                          recommendedSections = ["Adventure activities","Unexpected Saudi"];
                      }
                      else if (window.location.pathname.includes("/lifestyle")) {
                          mbox = "discover_lifestyle_mbox";
                          recommendedSections = ["Discover lifestyle activities in Saudi"];
                      }
                      else if (window.location.pathname.includes("/culture")) {
                          mbox = "discover_culture_mbox";
                          recommendedSections = ["Discover culture activities in Saudi"];
                      }
                      else if (window.location.pathname.includes("/family-activities")) {
                          mbox = "discover_family_mbox";
                          recommendedSections = [ "Discover family activities in Saudi"];
                      }
                      else if (window.location.pathname.includes("/food---drink/")) {
                          mbox = "food-what-to-eat-mbox";
                          recommendedSections = ["What to eat","Trending Food & Drinks" , "Guides"];
                      }
                      else if (window.location.pathname.includes("/package-details")) {
                          mbox = "packages-mbox";
                          recommendedSections = ["Packages", "Explore Packages"];
                      }
                      else if ( window.location.pathname.includes("/arabian-experiences/") ) {
                          mbox = "browse-destination-mbox";
                          recommendedSections = [ "Browse by destination ", "Trending tours" , "Best experiences and tours" , "Featured experiences & tours"];
                      }
                      // guides
                      else if ( window.location.pathname.includes("/guides/") ) {
                          mbox = "guides-mbox";
                          recommendedSections = ["What to eat","Guides"];
                      }
                      // itineraries
                      else if (window.location.pathname.includes("/itineraries/")) {
                          mbox = "itineraries-mbox";
                          recommendedSections = ["itineraries"];
                      }
                      // this one should be the last if "/en/do/""
                      else if (window.location.pathname.includes("/en/do/")) {
                          mbox = "trending-mbox";
                          recommendedSections = ['Trending Activities & Attraction', 'Trending tours'];
                      }
                      if (mbox) {
                          const airTargetInfo = {
                              entityName: '',
                              recommendedSections: recommendedSections,
                              entityCategory: "",
                              mboxName:mbox
                          };
                          window.airTargetInfo = airTargetInfo;
                      } 
                  }

        </script>
        <sly data-sly-test="${mode.saudiModeConfig.mode == 'air'}">
            <meta name="at_property" property="at_property" content="56ed5f6c-d67f-c490-62d0-d0c7e95f5f95">
            <script>
                  function targetPageParams() {
                      return {at_property: "56ed5f6c-d67f-c490-62d0-d0c7e95f5f95",};
                  }
                  setAirTargetInfo(); // this should be run before the adobedtm script

            </script>
            <script
                type="text/javascript"
                src="https://assets.adobedtm.com/c68cd5f9e870/c1f9b98f49b1/launch-7032a1efcd16-development.min.js"
                async
            ></script>
        </sly>
        <sly data-sly-test="${mode.saudiModeConfig.mode == 'qa'}">
            <meta name="at_property" property="at_property" content="ecc715ff-fdc7-505e-f63d-ccb619d959d6">
            <script> 
                  function targetPageParams() {
                      return {at_property: "ecc715ff-fdc7-505e-f63d-ccb619d959d6",};
                  }
                  setAirTargetInfo(); // this should be run before the adobedtm script

            </script>
            <script type="text/javascript"
                    src="https://assets.adobedtm.com/c68cd5f9e870/c1f9b98f49b1/launch-e0a2ed659af0-development.min.js"
                    async></script>
        </sly>
        <sly data-sly-test="${mode.saudiModeConfig.mode == 'dev'}">
            <meta name="at_property" property="at_property" content="56ed5f6c-d67f-c490-62d0-d0c7e95f5f95">
            <script>
                  function targetPageParams() {
                      return {at_property: "56ed5f6c-d67f-c490-62d0-d0c7e95f5f95",};
                  }
                  setAirTargetInfo(); // this should be run before the adobedtm script

            </script>
            <script type="text/javascript"
                    src="https://assets.adobedtm.com/c68cd5f9e870/c1f9b98f49b1/launch-ea208b6d49a1-development.min.js"
                    async></script>
        </sly>
        <sly data-sly-test="${mode.saudiModeConfig.mode == 'acc'}">
            <meta name="at_property" property="at_property" content="a486bc2c-ced9-1e60-63fc-8d15c0f03aa0">
            <script> 
                  function targetPageParams() {
                      return {at_property: "a486bc2c-ced9-1e60-63fc-8d15c0f03aa0",};
                  }
                  setAirTargetInfo(); // this should be run before the adobedtm script

            </script>
            <script type="text/javascript"
                    src="https://assets.adobedtm.com/c68cd5f9e870/c1f9b98f49b1/launch-d1d2f74bada3-staging.min.js"
                    async></script>
        </sly>
        <sly data-sly-test="${mode.saudiModeConfig.mode == 'prod'}">
            <meta name="at_property" property="at_property" content="773a1709-214b-ac76-2a26-117d012d7031">
            <script> 
                  function targetPageParams() {
                      return {at_property: "773a1709-214b-ac76-2a26-117d012d7031",};
                  }
                  setAirTargetInfo(); // this should be run before the adobedtm script

            </script>
            <sly data-sly-test.publish="${mode.saudiModeConfig.publish}">
                <script>
            var userAgent = navigator.userAgent;
    if (userAgent.indexOf('miniProgram') === -1 && userAgent.indexOf('MicroMessenger') === -1) {
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = 'https://assets.adobedtm.com/c68cd5f9e870/c1f9b98f49b1/launch-d7d511425437.min.js';
        script.async = true;
        document.head.appendChild(script);
    }

                </script>
            </sly>
            <sly data-sly-test="${!publish}">
                <script type="text/javascript"
                        src="https://assets.adobedtm.com/c68cd5f9e870/c1f9b98f49b1/launch-d1d2f74bada3-staging.min.js"
                        async></script>
            </sly>
        </sly>
    </sly>
</sly>
<script>
      /*    Set the entityName for airTargetInfo */
     window.addEventListener("load", function() {
      if( window.airTargetInfo && window.airTargetInfo.mboxName){
          const titleElement =  document.querySelector("h1.title") || document.querySelector("h1.slide-title");
          window.airTargetInfo = { ...window.airTargetInfo, entityName: titleElement?titleElement.innerHTML: ""};
      }
       }, false);

</script>
  
  